---
title: "Working with genetic sequences: the tidy way"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Working with genetic sequences: the tidy way}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

The multiple R packages that exist for DNA data analysis do not fit well into the tidyverse. The painseq package is an attempt to facilitate this integration.

The philosophy is to keep things as simple as possible. Rather than defining new classes, genetic sequences are stored as simple vectors of character strings.

This has the advantage of being directly compatible with R base. The strings containing the sequences can be stored in tibble columns, as can the data associated with each record. This allows you to use the power and expressiveness of tidyverse to transform, visualize and model your data.

What does painseq do? Not much. It simply provides utility functions to 

# Conversion among sequence formats

# Standard string operation with stringr 

# Special sequence operations

# Quick access to sequence alignment viewers

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(tidyverse)
library(painseq)
```

```{r}
my_seq <- ape::rDNAbin(nrow = 50, ncol = 250) 
my_seq

image(my_seq)

my_tidy_seq <- DNAbin_to_tibble(my_seq)

my_tidy_seq
```


# String operation with stringr

## Filtering

```{r}
my_tidy_seq %>% 
  filter(str_detect(sequence, "AAAA"))
```

```{r}
my_tidy_seq %>% 
  mutate(seq_pad = str_trunc(sequence, 3, "left", ellipsis = "..."))
str_
```


# DNA specific operation

Complement/ reverse complement

Consensus




